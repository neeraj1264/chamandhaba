let menubar=document.querySelector("#menu-bars"),mynav=document.querySelector(".navbar");menubar.onclick=()=>{menubar.classList.toggle("fa-times"),mynav.classList.toggle("active")};const navbarItems=document.querySelectorAll(".navbar a:not(#menu-bars)");navbarItems.forEach(e=>{e.addEventListener("click",()=>{mynav.classList.contains("active")&&(menubar.classList.toggle("fa-times"),mynav.classList.toggle("active"))})});var cartData={};let cartCount=0,cartCountElement=document.getElementById("cart-count");function handleAddToCartClick(e){let t=e.target.closest(".add-to-cart");if(t){if(isUserSignedUp()){if(isUserSignedUp()){let a=t.parentNode.querySelector(".quantity-control");t.style.display="none",a.style.display="flex",cartCount++,cartCountElement.textContent=cartCount}}else e.preventDefault(),alert("Enter Your Address First\n\n Note: This is a one-time requirement."),window.location.href="signup.html"}}function calculateitemTotal(){let e=0;for(let t in cartData)cartData.hasOwnProperty(t)&&(e+=cartData[t].quantity*cartData[t].price);return`₹ ${e.toFixed(2)}`}function calculateTotal(){let e=20;for(let t in cartData)cartData.hasOwnProperty(t)&&(e+=cartData[t].quantity*cartData[t].price);return`₹ ${e.toFixed(2)}`}function getRandom4DigitNumber(){return Math.floor(1e3+9e3*Math.random())}function submitOrder(e){let t=getRandom4DigitNumber(),a=JSON.parse(localStorage.getItem("userData"));var n=`Order      : *ORD-${t}*
`;for(let l in n+=`Phone    : *${a.mobileNumber}*
`,n+=`Name     : *${a.name}*
`,n+=`Amount : *${calculateTotal()}*
`,n+=`Address : *${a.address}*

`,n+="----------items----------\n\n",e)if(e.hasOwnProperty(l)){let r=e[l];n+=`${r.quantity}.0 x   ${r.name} = ₹ ${r.price}
`}var i="https://api.whatsapp.com/send?phone=+919896755380&text="+encodeURIComponent(n+=`Service Charge = ₹ 20.00
`);window.open(i,"_blank"),setTimeout(function(){showPopup()},5e3)}document.querySelector(".paneer").addEventListener("click",e=>{handleAddToCartClick(e)}),document.querySelector(".mushroom").addEventListener("click",e=>{handleAddToCartClick(e)}),document.querySelector(".dal").addEventListener("click",e=>{handleAddToCartClick(e)}),document.querySelector(".kofta").addEventListener("click",e=>{handleAddToCartClick(e)}),document.querySelector(".chaap").addEventListener("click",e=>{handleAddToCartClick(e)}),document.querySelector(".chana").addEventListener("click",e=>{handleAddToCartClick(e)}),document.querySelector(".vegetable").addEventListener("click",e=>{handleAddToCartClick(e)}),document.querySelector(".rice").addEventListener("click",e=>{handleAddToCartClick(e)}),document.querySelector(".naan").addEventListener("click",e=>{handleAddToCartClick(e)}),document.querySelector(".roti").addEventListener("click",e=>{handleAddToCartClick(e)}),document.querySelector(".paratha").addEventListener("click",e=>{handleAddToCartClick(e)}),document.querySelector(".rayta").addEventListener("click",e=>{handleAddToCartClick(e)}),document.querySelector(".salad").addEventListener("click",e=>{handleAddToCartClick(e)}),document.querySelector(".chinese").addEventListener("click",e=>{handleAddToCartClick(e)});let isCartModalOpen=!1;function showCartModal(){if(0===Object.keys(cartData).length){closeCartModal();return}if(document.getElementById("cartModal").style.display="block",isCartModalOpen=!0,document.getElementById("dark-mode-toggle").style.display="none",cartCount<1){alert("Please add items to the cart first."),closeCartModal();return}let e=document.getElementById("menu-head");e&&(e.style.display="none");let t=document.getElementById("cartModal");t.style.display="block";let a=document.getElementById("cartItems");a.innerHTML="",a.style.maxHeight="500px",a.style.overflowX="auto";let n=document.createElement("table");n.classList.add("cart-table");let l=document.createElement("tr"),r=["Image","Name","Quantity","Price"];for(let i of r){let d=document.createElement("th");d.textContent=i,("Name"===i||"Quantity"===i||"Image"===i||"Price"===i)&&d.classList.add("header-spaced"),l.appendChild(d)}for(let o in n.appendChild(l),cartData)if(cartData.hasOwnProperty(o)){let c=cartData[o],s=document.createElement("tr"),m=document.createElement("td");m.classList.add("center-align");let u=document.createElement("img");u.src=c.image,u.alt=c.name,m.appendChild(u),s.appendChild(m);let p=document.createElement("td");p.classList.add("center-align"),p.textContent=c.name,s.appendChild(p);let y=document.createElement("td");y.classList.add("center-align");let h=document.createElement("i");h.classList.add("fas","fa-minus","quantity-icon"),h.setAttribute("data-item-id",o),h.addEventListener("click",()=>{c.quantity>1?(c.quantity--,C.textContent=c.quantity,updatePrice(c,f),T.textContent=`${calculateitemTotal()}`,H.textContent=`${calculateTotal()}`):(delete cartData[o],showCartModal(),updateCartCount(),T.textContent=`${calculateitemTotal()}`,H.textContent=`${calculateTotal()}`)}),y.appendChild(h);let C=document.createElement("span");C.classList.add("item-quantity"),C.textContent=c.quantity,y.appendChild(C);let g=document.createElement("i");g.classList.add("fas","fa-plus","quantity-icon"),g.setAttribute("data-item-id",o),g.addEventListener("click",()=>{c.quantity++,C.textContent=c.quantity,updatePrice(c,f),T.textContent=`${calculateitemTotal()}`,H.textContent=`${calculateTotal()}`}),y.appendChild(g),s.appendChild(y);let f=document.createElement("td");f.classList.add("center-align"),f.textContent=`₹ ${c.price*c.quantity}`,s.appendChild(f),n.appendChild(s)}let v=document.createElement("tr"),b=document.createElement("td");b.classList.add("footer-hr-cell"),v.appendChild(b);let E=document.createElement("td");E.classList.add("footer-hr-cell"),v.appendChild(E);let $=document.createElement("td");$.classList.add("footer-hr-cell"),v.appendChild($);let L=document.createElement("td");L.classList.add("footer-hr-cell"),v.appendChild(L),n.appendChild(v);let k=document.createElement("tr"),q=document.createElement("td");q.setAttribute("colspan",r.length),k.appendChild(q),n.appendChild(k);let x=document.createElement("tr"),I=document.createElement("td");I.textContent="Item-Total",I.classList.add("cart-footer"),x.appendChild(I);let S=document.createElement("td");S.setAttribute("colspan","2"),x.appendChild(S);let T=document.createElement("td");T.textContent=`${calculateitemTotal()}`,T.classList.add("cart-footer"),x.appendChild(T),n.appendChild(x);let D=document.createElement("tr"),_=document.createElement("td");_.textContent="Delivery",_.classList.add("cart-footer"),D.appendChild(_);let M=document.createElement("td");M.textContent="[ Upto 2km ]",M.classList.add("cart-footer"),D.appendChild(M);let A=document.createElement("td");A.setAttribute("colspan","1"),D.appendChild(A);let w=document.createElement("td");w.textContent="₹ 20",w.classList.add("cart-footer"),D.appendChild(w),n.appendChild(D);let P=document.createElement("tr"),B=document.createElement("td");B.textContent="Total",B.classList.add("cart-footer"),P.appendChild(B);let z=document.createElement("td");z.setAttribute("colspan","2"),P.appendChild(z);let H=document.createElement("td");H.textContent=`${calculateTotal()}`,H.classList.add("cart-footer"),P.appendChild(H),n.appendChild(P);let N=document.createElement("tr"),O=document.createElement("td");O.setAttribute("colspan","2"),N.appendChild(O);let j=document.createElement("td");j.setAttribute("colspan","2"),N.appendChild(j);let V=document.createElement("button");V.textContent="Place Order",V.classList.add("submit-button"),V.addEventListener("click",()=>{submitOrder(cartData)}),j.appendChild(V),n.appendChild(N);let F=document.createElement("tr"),R=document.createElement("td");R.setAttribute("colspan",r.length),F.appendChild(R),n.appendChild(F),a.appendChild(n)}function updatePrice(e,t){t.textContent=`₹ ${e.price*e.quantity}`}function closeCartModal(){document.getElementById("cartModal").style.display="none",isCartModalOpen=!1,document.getElementById("dark-mode-toggle").style.display="block";let e=document.getElementById("cartModal");e.style.display="none"}function addToCart(e,t,a,n,l){cartData.hasOwnProperty(e)?cartData[e].quantity+=1:cartData[e]={name:t,price:a,image:n,quantity:1},updateCartCount()}function showDropdown(e){let t=document.getElementById(`dropdown-${e}`);t.style.display="block"}function hideDropdown(e){let t=document.getElementById(`dropdown-${e}`);t.style.display="none"}function addToCartWithSize(e,t,a){let n=document.getElementById(`dropdown-options-${e}`),l=n.options[n.selectedIndex].text,r=l.split("-")[0].trim(),i=parseInt(l.split("₹")[1]);addToCart(e,`${t} (${r})`,i,a)}function updateCartCount(){let e=document.getElementById("cart-count"),t=0;for(let a in cartData)cartData.hasOwnProperty(a)&&(t+=cartData[a].quantity);e.textContent=t}let http=new XMLHttpRequest;function toggleDarkMode(){let e=document.body;e.classList.toggle("dark-mode");let t=document.getElementById("mode-icon");e.classList.contains("dark-mode")?(t.classList.remove("fa-moon"),t.classList.add("fa-sun"),localStorage.setItem("darkMode","enabled")):(t.classList.remove("fa-sun"),t.classList.add("fa-moon"),localStorage.setItem("darkMode","disabled"))}function zoomImage(e){let t=document.getElementById("zoomed-image"),a=document.getElementById("image-zoom-container");t.src=e.src,a.style.display="block"}function closeZoomImage(){let e=document.getElementById("image-zoom-container");e.style.display="none"}function increaseValue(e){var t=parseInt(document.getElementById(`number-${e}`).value,10);t=isNaN(t)?0:t,t++,document.getElementById(`number-${e}`).value=t,updateCartData(e,t)}function decreaseValue(e){var t=document.getElementById(`number-${e}`),a=parseInt(t.value,10);(a=isNaN(a)?0:a)>1?(a--,t.value=a,updateCartData(e,a)):(t.value=1,delete cartData[e],updateCartCount(),hideQuantityContainer(e))}function updateCartData(e,t){cartData.hasOwnProperty(e)&&(cartData[e].quantity=t)}function hideQuantityContainer(e){let t=document.getElementById(`number-${e}`).closest(".quantity-control");t.style.display="none",cartCount--,cartCountElement.textContent=cartCount;let a=t.parentNode.querySelector(".add-to-cart");a.style.display="inline-block"}function generateAndDownloadInvoice(e,t,a,n){let l=JSON.parse(localStorage.getItem("userData")),{name:r,address:i,mobileNumber:d}=l,o=[];for(let c in o.push(["Products","Quantity","Price","Total"]),n)if(n.hasOwnProperty(c)){let s=n[c];o.push([s.name,s.quantity,`₹ ${s.price}`,`₹ ${s.price*s.quantity}`,])}let m=Object.values(n).reduce((e,t)=>e+t.price*t.quantity,0),u={content:[{text:"Chaman Dhaba",style:"header"},{text:"Pehowa, Haryana, 136128",style:"headerr"},{text:"Phone Number - +91 98967-55380",style:"headerr"},{canvas:[{type:"line",x1:0,y1:10,x2:515,y2:10,lineWidth:2}],margin:[0,20]},{text:"Invoice Details",style:"subheader"},{text:`Customer Name   -     ${r}`,style:"customerInfo"},{text:`Address                 -     ${i}`,style:"customerInfo"},{text:` Phone Number     -     ${d}`,style:"customerInfoWithSpace"},{table:{widths:["*","auto","auto","auto"],headerRows:1,alignment:"center",margin:[0,10,0,0],body:o},style:"tableStyle"},{text:`Item Total:          ₹ ${m.toFixed(2)}`,style:"total"},{text:`Service Charge:   ₹ 20.00  `,style:"totall"},{text:`Total Amount:    ₹ ${(m+20).toFixed(2)}`,style:"totall"},],styles:{header:{fontSize:35,bold:!0,alignment:"center",margin:[0,0,0,10]},headerr:{fontSize:25,alignment:"center",margin:[0,0,0,10]},subheader:{fontSize:25,bold:!0,alignment:"center",margin:[0,10,0,5]},total:{fontSize:25,bold:!0,alignment:"right",margin:[0,60,0,0]},totall:{fontSize:25,bold:!0,alignment:"right",margin:[0,10,0,0]},tableStyle:{fontSize:15},customerInfo:{fontSize:20,alignment:"left",margin:[0,10,0,0]},customerInfoWithSpace:{fontSize:20,alignment:"left",margin:[0,10,0,20]}}},p=pdfMake.createPdf(u);p.download("invoice.pdf")}function showPopup(){var e=document.createElement("div");e.className="popup";var t=document.createElement("button");t.textContent="X",t.className="close-button",t.addEventListener("click",function(){location.reload()});var a=document.createElement("p");a.textContent="Order placed successfully!";var n=document.createElement("div");n.className="button-container";var l=document.createElement("button");l.textContent="Download Invoice",l.classList.add("popup-invoice-button"),l.addEventListener("click",function(){generateAndDownloadInvoice("Chaman Dhaba","Neeraj Manchanda","+91 98967-55380",cartData)}),e.appendChild(t),e.appendChild(a),n.appendChild(l),e.appendChild(n);var r=document.createElement("div");function i(){r.style.display="none",e.style.display="none"}r.className="overlay",document.body.appendChild(r),document.body.appendChild(e),r.style.display="block",e.style.display="block"}function isUserSignedUp(){let e=localStorage.getItem("userData");return null!==e}http.open("get","products.json",!0),http.send(),http.onload=function(){if(4==this.readyState&&200==this.status){let e=JSON.parse(this.responseText);function t(e){return`
    <div class="box" >
    <span class="dis product-price"><b>${Math.round((e.mrp-e.price.Half)/e.mrp*100)}</b>% off</span>
    <img src="${e.image}" alt="img" onclick="zoomImage(this)">
    <h3 class="product-name" >${e.name}</h3>
     <div class="stars"></div>
    <div class="dropdownn" id="dropdown-${e.id}" style="display: flex;">
    <select class="size" id="dropdown-options-${e.id}">
      <option value="Half">Half - ₹${e.price.Half}</option>
      <option value="Full">Full - ₹${e.price.Full}</option>
    </select><br><br>
  </div>
  <button class="btn btn-ok add-to-cart" onclick="addToCartWithSize('${e.id}', '${e.name}', '${e.image}')">Add</button>
  
  <form class="quantity-control" style="display: none;">
  <div class="value-button decrease" onclick="decreaseValue(${e.id})" value="Decrease Value"><i class="fas fa-minus-circle"></i></div>
  <input type="number" class="number" id="number-${e.id}" value="1" readonly />
  <div class="value-button increase" onclick="increaseValue(${e.id})" value="Increase Value"><i class="fas fa-plus-circle"></i></div>
 </form>

    </div>
    `}function a(e){return`
  <div class="box" >
  <span class="dis product-price"><b>${Math.round((e.mrp-e.price)/e.mrp*100)}</b>% off</span>
  <img src="${e.image}" alt="img" onclick="zoomImage(this)">
  <h3 class="product-name" >${e.name}</h3>
  <span class="pricee product-price"> <b>₹ ${e.price}</b> 
  <del class="mrp">₹ ${e.mrp}</del>
   <span class="rev"> 4.7 <i class="fas fa-star"></i></span>
   </span>
   <div class="stars"></div>
  
  <h2 class="btn add-to-cart "  onclick="addToCart('${e.id}', '${e.name}', ${e.price}, '${e.image}') ">ADD</h2>
 
  <form class="quantity-control" style="display: none;">
  <div class="value-button decrease" onclick="decreaseValue(${e.id})" value="Decrease Value"><i class="fas fa-minus-circle"></i></div>
  <input type="number" class="number" id="number-${e.id}" value="1" readonly />
  <div class="value-button increase" onclick="increaseValue(${e.id})" value="Increase Value"><i class="fas fa-plus-circle"></i></div>
 </form>
  
  </div>
  </div>
  </div>
  `}let n="",l="",r="",i="",d="",o="",c="",s="",m="",u="",p="",y="",h="",C="";for(let g=0;g<e.length;g++){let f=e[g];g<12&&(n+=t(f),n+=`
<div class="image-zoom-container" id="image-zoom-container">
  <span class="close-zoom" onclick="closeZoomImage()">&times;</span>
  <img class="zoomed-image" id="zoomed-image">
</div>
`),g>=12&&g<17&&(l+=t(f)),g>=17&&g<24&&(r+=t(f)),g>=24&&g<26&&(i+=t(f)),g>=26&&g<28&&(d+=t(f)),g>=28&&g<32&&(o+=t(f)),g>=32&&g<41&&(c+=t(f)),g>=41&&g<43&&(s+=a(f)),g>=43&&g<46&&(s+=t(f)),g>=47&&g<53&&(m+=a(f)),g>=53&&g<59&&(u+=a(f)),g>=59&&g<65&&(p+=a(f)),g>=66&&g<71&&(y+=t(f)),g>=71&&g<74&&(h+=a(f)),g>=74&&g<77&&(C+=t(f))}document.querySelector(".paneer").innerHTML=n,document.querySelector(".mushroom").innerHTML=l,document.querySelector(".dal").innerHTML=r,document.querySelector(".kofta").innerHTML=i,document.querySelector(".chaap").innerHTML=d,document.querySelector(".chana").innerHTML=o,document.querySelector(".vegetable").innerHTML=c,document.querySelector(".rice").innerHTML=s,document.querySelector(".naan").innerHTML=m,document.querySelector(".roti").innerHTML=u,document.querySelector(".paratha").innerHTML=p,document.querySelector(".rayta").innerHTML=y,document.querySelector(".salad").innerHTML=h,document.querySelector(".chinese").innerHTML=C}},document.addEventListener("DOMContentLoaded",function(){let e=document.body,t=document.getElementById("mode-icon"),a=localStorage.getItem("darkMode");"enabled"===a?(e.classList.add("dark-mode"),t.classList.remove("fa-moon"),t.classList.add("fa-sun")):(e.classList.remove("dark-mode"),t.classList.remove("fa-sun"),t.classList.add("fa-moon"))});const menuheader=document.getElementById("menu-head"),navbar=document.querySelector(".navbar"),specificScrollPosition=1896;window.addEventListener("scroll",function(){(window.scrollY||window.scrollY)>1896&&!isCartModalOpen?(menuheader.style.display="flex",navbar.classList.add("activee")):(menuheader.style.display="none",navbar.classList.remove("activee"))});const menuItems=[{id:"paneer",image:"shahipaneer.jpeg",name:"Paneer"},{id:"mushroom",image:"mm.jpeg",name:"Mushroom"},{id:"dal",image:"dalmakhani.jpeg",name:"Dal"},{id:"chaap",image:"gravychaap.jpeg",name:"Chaap"},{id:"chana",image:"chanamasala.jpeg",name:"Chana"},{id:"vegetable",image:"mixveg.jpeg",name:"Vegetable"},{id:"rice",image:"jeerarice.jpeg",name:"Rice"},{id:"naan",image:"butternaan.jpeg",name:"Naan"},{id:"roti",image:"tandooriroti.jpeg",name:"Roti"},{id:"paratha",image:"paneerparata.jpeg",name:"Paratha"},{id:"rayta",image:"mixrayta.jpeg",name:"Rayta"},{id:"salad",image:"greensalad.jpeg",name:"Salad"},{id:"chinese",image:"cheesepan.jpg",name:"Chinese"},];function generateMenuItems(){let e=document.getElementById("menu-head");menuItems.forEach(t=>{let a=document.createElement("div");a.classList.add("menu-item");let n=document.createElement("a");n.href=`#${t.id}`;let l=document.createElement("img");l.src=`images/${t.image}`,l.alt=t.name;let r=document.createElement("span");r.classList.add("menu-name"),r.textContent=t.name,n.appendChild(l),n.appendChild(r),a.appendChild(n),e.appendChild(a)})}generateMenuItems();